## Лирическое отступление
Гауссовские процессы и их возможные применения
Описание физических процессов в моделировании
Мат. ожидание и ковариационная функция

непараметрические методы в статистике для машинного обучения

постановка задачи
дана обучающая выборка

$$
D = {\{x_i, y_i\}}_{i=1}^n \quad x_i,y_i \in \mathbb{R}
$$

$$
y_i = f(x_i) + \varepsilon_i
$$

Эпсилон иногда пишут иногда нет

$f(x)$ - гауссовский процесс с 0 вектором средних (можно ослабить). $x$ олицетворяет время в процессе  $(X_t, t \in T)$

$$
f \sim GP(m(x), \kappa(x, x^\prime))
$$

$$
\kappa(x, x^\prime) = \kappa(x-x^\prime)
$$
это если процесс какой-то специфичный
получаем задачу регрессии???

Дали выборку, надо найти прогноз $y^*$ для $x^*$

$$
Y = (y_1, ..., y_n)^T
$$
вектор целевых переменных в обучающей выборке

$$
X = (x_1, ..., x_n)^T
$$
вектор признаков

Записывается прогнозное распределение (совместное)

откуда-то берется многомерное нормальное распределение

$$
[y,y^*] \sim \mathbb{N}(\mathbb{0}_{n+1}, \Gamma)
$$

$$
\Gamma = 
\begin{aligned}
& \kappa(X,X) _{m \cdot n} & \kappa(x, x^*)_{n \cdot 1} \\
& \kappa(x^*, x)_{1\cdot n} & \kappa(x^*, x^*)_{1\cdot 1}
\end{aligned}
$$

И надо найти

$$
y^*|_{yX} \sim \mathbb{N}(m, s^2)
$$

![[IMG_1563.jpeg|300]]

что-то с поиском условного распределения из совместного

$m(x)$ и $s^2(x)$ находятся тривиально

Параметров пока что нет они могут быть в ковариации но один хрен параметры обучения подменяются параметрами вероятностей так что а??? разобраться попозже

библиотека `GPy` там говорят что-то по теме

аналогично можно подумать и для задачи классификации

другая область применения это [байесовская оптимизация](http://krasserm.github.io/2018/03/21/bayesian-optimization/) - поиск минимума или максимума какой-то функции

может функция быть неизвестна в явном виде, можно только посчитать очень сильно затратно -> нельзя найти градиент -> нельзя применить градиентный спуск/подъем

Есть кач-во, кот. рассматривается как список параметров. чтобы его рассчитать надо полноценно обучить модель, получить кач-во для гиперпараметра.

я хочу спать

один из стандартных подходов это использовать гауссовские процессы

интерпретировать ф-ю как реализацию гауссовского процесса. допускаем, что эта хрень - порождение гауссовского процесса

#### сам алго вкратце

![[Pasted image 20250211135924.png]]

находим кандидата путем решения вспомогательной оптимизационной задачи но попроще

сгенерируем $y(t)$

добавим в набор данных

там какой-то файл нихера не видно

ы

рассматривается какая-то разница между максимумом и чем-то там берется мат ожидание относительно того же распределения че то там куда то там

#### Байесовская оптимизация в AlphaGo

вроде про го сказали

оптимизация для гипепараметров модели

добавляем МЛ в список prerequisites к курсу

че то еще какая-то статейка где ее достать я хз

#### Синтез какой-то химии

????????

**ЛИРИЧЕСКОЕ ОТСТУПЛЕНИЕ ОКОНЧЕНО**

собсна по лекциям дальше

# Моделирование марковских цепей (процессов????)

рассматривается м.ц. с дискретным временем и конечным пространством состояний

![[Pasted image 20250211141445.png]]

$$
x_n \in E = \{1, ... n\}
$$

Если процесс однородный, то матрица переходных вероятностей не меняется (св-ва м.п.). Если не однородная, нужен еще и алго смены матрицы перехода

Должно быть начальное распределение и матрица перехода (однозначно характеризует м.п.)

![[Pasted image 20250211141626.png]]

$$
\sum p_i = 1
$$

генерируем начальное состояние - генерируем ДСВ

генерируем переход в следующее состояние - смотрим на $i$-ю строку матрицы - вер-ть ухода из этого состояния (распределение ДСВ)

и т д повторить процесс сколько нужно - генерируется траектория - последовательность состояний

# Моделирование изотропного вектора

или равномерное распределение на сфере единичного радиуса

изотропный - одинаковый по вероятности во всех направлениях (в этом контексте)

иначе говоря рассматриваем ~~точку~~ кукуху в пространстве и кидаем направление куда она поедет при рассеивании частиц - может переместиться в любом направлении в пространстве причем с одинаковой вероятностью. ~~прямо как мы пойдем нахер с экзамена~~ кхъ

направление определяется единичным направляющим вектором. множ-во единичных векторов направленных из точки лежит на окружности/сфере/гиперсфере/...

рассмотрим плоскость и окружность на ней. в этом случае введем полярные координаты и сгенерировать $\varphi \sim \mathfrak{U}(0, 2\pi)$ берем косинус и синус, получаем координаты

в 3х мерном пространстве введем сферическую систему координат

![[Pasted image 20250211142506.png]]

$\varphi \in [0, \pi]$,  $\theta \in [0, 2\pi]$

![[IMG_1567.jpeg|300]]

Если взять оба угла по равномерному распределению, то получится смещение в сторону оси z. потому что площадь зависит от углов нелинейно а значит равномерное распределение отобразится на неравномерное (как жопка у воздушного шарика)

по принципу отбора

если есть $\mathfrak{U}(A)$ и $B \subset A$ то мера В на меру А (площадь на площадь/ ...)

площадь сферы $\Omega = 4\pi$, 

область изменения параметров - квадратик на плоскости - отобразится на сферу - получится кусочек сферы $d\Omega$

![[IMG_1568.jpeg|300]]

когда нибудь в следующей жизни я нарисую эту херь в геогебре

![[Pasted image 20250211143307.png]]

сюда же приплетается якобиан для сферических координат

много формул пока скопирую потом перепишу

![[Pasted image 20250211143454.png]]

$d\Omega / \Omega$ - мера куска на площадь всей сферы

![[Pasted image 20250211143546.png]]

$\phi \in d\phi$ $\theta \in d\theta$

а это по определению интеграл от плотности. поскольку д-шки малы, вспоминаем теорему о среднем и упростим

$$
\int_x^{x+\Delta x} f(t)dt ≈ f(x)\Delta x
$$

это для одномерного, а перенесем на многомерное и получим вышестоящий кусок

По итогу получим $\sin\phi / 4\pi$

имеем плотность, можем найти маргинальные распределения (интегрировать). матанализ. фу

100500 лет матанализа спустя

$$P_\theta = \frac{1}{2\pi}$$

$$P_\phi = \frac{\sin\phi}{2}$$

а значит они независимы (потому что перемножаем получаем совместную плотность)

отсюда находим CDF($\phi$) = $\frac{1-\cos\phi}{2}$

и обратную ей $F^{-1}(u) = \arccos(1-2U)$

значит косинус угла распределен равномерно на [-1, 1] (косинус от аркосинуса это сам аргумент)

ы

кажется поняла но не совсем 

это очень логично

потому что косинус он и подразумевает смещение к экватору

звуки осознания

## Альтернативный способ генерации

Пусть с.в. $X,Y,Z$ независимы и $\sim \mathbb{N}(0,1)$ тогда $(X,Y,Z)$ - изотропный вектор (ненормированный но тем не менее). док-во похоже на Бокса-Мюллера

Переведем в сферические координаты $(X,Y,Z) \rightarrow (R, \Phi, \Theta)$

подставим туда формулы для сферических координат

модуль якобиана $r^2 \sin \phi$

интегрируем по радиусу, получаем совместную плотность для пары углов. почему? интуицию включить бы

как нормировать???? не услышала

едем дальше гхы 

# генерация точек на произвольной поверхности

## генерация точек на кривых в пространстве

пусть задана кривая в параметрической форме

![[Pasted image 20250211145130.png]]

нужно найти распределение параметра $t$, которое позволит получить равновероятное распределение точек на кривой

по аналогии с изотропным вектором есть кривая, есть дуга на этой кривой и нужно раскидать равномерно на ней точки

вероятность попасть в $dl$ пропорциональна мере (длине отрезка)

длина дуги кривой в параметрической форме

![[Pasted image 20250211145402.png]]

в числителе приращение (отрезочек из приращений (производных), хорда на концах микрокусочка дуги), в знаменателе вся дуга через интеграл

найду конспект по матану приложу кусок еще и оттуда

и эта огромнючая дробь это плотность распределения параметра (одномерная на секундочку)

з.ы. если кривая это прямая, то абсцисса это и есть параметр и он будет раскидан равномерно

тут закончилась первая лекция

## Переносим на пространство

параметрически заданная поверхность

![[Pasted image 20250211151746.png]]

сфера это частный случай поверхности, там роль параметров играли углы.

найти такой набор параметров, при кот. точки на поверхности были бы раскиданы равномерно

опять же рисуем кусок поверхности, определяем $(du, dv) \rightarrow dS$ - некоторое малое приращение параметров

![[Pasted image 20250211151958.png]]

знаменатель - площадь всей поверхности, числитель - площадь приращения

**лирическое отступление почему ds**

зафиксируем один параметр, варьируя второй. получим кривую на поверхности. поменяем фиксацию получим другую кривую. проведем к каждой кривой касательную в точке. получили касательную плоскость (брух.... матанализ.....). ввиду малых приращений допустим примерное равенство куска поверхности и его проекции на касательную плоскость

![[IMG_1572.jpeg|300]]

введем какой-то радиус вектор зачем-то

касательные плоскости определяются частными производными по u и v. в кач-ве меры площади ds берется площадь параллелограмма на этих радиус векторах. а это модуль векторного произведения этих радиус векторов. и он считается как 

$$
|a \times b| = |a| \cdot |b| \cdot \sin\varphi
$$

$$
|r_u \times r_v|^2 = r_u^2 \cdot r_v^2 \cdot \sin^2\varphi = r_u^2 \cdot r_v^2 - (r_u, r_v)
$$

$$
r_u = (x_u, y_u, z_u) \quad r_v = (x_v, y_v, z_v)
$$

это что-то из матана, линала и геомы, повторение с 1-2 курсов

![[IMG_1574.jpeg|300]]

![[IMG_1575.jpeg|300]]

## Пример - поверхность тора

![[Pasted image 20250211153042.png]]

$r$ - радиус малой окружности

$R$ - радиус большой окружности, по кот. едет центр малой окружности

дальше на слайдах те же преобразования, описанные ранее только конкретно для тора. 

> Дифференцируй не хочу. И не буду на лекции. Технические выкладки за вами
> $\textcopyright$ Лукашенко

Там что-то с 1м заданием из лабы

_где это применяется (для следующей лабы???)_

- для создания композиционных материалов (усиление конструкций - армировка)

# Моделирование процесса переноса частиц

рассматривается процесс движения частиц в (возможно неоднородной) среде. под частицами подразуемвается много чего, по большей части радиоактивные частицы при ядерном распаде, фотоны, ...

рассеивание - изменение направления. вопрос: _каким образом?_

тут какой-то пример с переносом частиц в органическим средам - тканям организмов, в т ч человека. пример о том как измерять насыщение кислородом сетчатки глаза (ретинальная оксиметрия) с помощью метода монте карло

10 минут раскапывали строение глаза..... зачем.......

изотропное рассеивание - достаточно нереалистичное предположение. скажем, что оно _анизотропное_ 

как же болит голова от этих осознаний

параметры среды влияют на _рассеивание_ (изменение траектории) и _поглощение_ (прекращение движения - траектория больше не отслеживается) частицы (в этом случае фотона)

рассматривается траектория частицы от столкновения до столкновения

==длина свободного пробега ($S$)== - расстояние, пройденное частицей от столкновения до столкновения. что-то там экспоненциально и зависит от параметров среды. чем более оптически прозрачная среда, тем больше длина свободного пробега и наоборот

сгенерировать вероятность поглощения??????

![[Pasted image 20250211155558.png]]

пусть дана точка столкновения $(x_0, y_0, z_0)$ и $V$ - нормированный вектор перемещения после столкновения

для рассеивания нужно определить $V$

предполагается (доп. предположения), что частица отклонилась от первоначальной траектории на $\theta$ и угол поворота этого вектора $\varphi$ и рассеивание определяется этими 2 углами (аксиальная симметрия вокруг оси - предыдущего направления частицы)

распределение этих 2х углов - ==фазовая функция рассеивания==

под ней подразумевается: 

$\omega$ - исх. направление, $\omega^\prime$ - новый вектор. картинку с доски вставлю

![[IMG_1576.jpeg|300]]

рассмотрели уже пример такого раскидывания - изотропное рассеивание на сфере

в аксиальной симметрии все будет определяться косинусом угла м/у $\omega$ и $\omega^\prime$

![[Pasted image 20250211160611.png]]

потом покрасивше перепишу

_откуда такая формула_

это обобщение изотропного рассеивания (почему????)

подставим туда 0, получим плотность неравномерного угла для изотропного рассеивания

вот эти графики

![[Pasted image 20250211160911.png]]

понимать так

берем точку на кривой. длина отрезка от начала координат до данной точки - вероятность пойти в этом направлении

(а сначала я подумала на эллипсы, где начало координат в точке фокуса. наверное что-то около этого будет чуть позже но я хз. и еще $|g|$ очень похож на эксцентриситет таких эллипсов, но это не точно)

$\xi$ моделируется методом обратной ф-и, $\varphi$ распределен равномерно

вот эти картинки кстати

![[Pasted image 20250211161450.png]]

сгенерены на R

а вот так

![[Pasted image 20250211161831.png]]

рассчитывается новый направляющий вектор, зная старый и 2 угла

чзх???? вроде как умножение вектора на какую-то матрицу поворота но это не точно (и не применимо к 3д векторам, только к 4д)

выберем новую систему координат например такую, чтобы новая ось $z$ совпала с направляющим вектором. введем прямоугольные координаты $(u, v, w)$

$$|V| = 1$$

$$
V = (V_x, V_y, V_z)
$$

$$
U = (-V_y, V_x, 0)
$$

$$
W = V \times U = (V_xV_z, V_yV_Z, -(1-V_Z^2))
$$

![[IMG_1578.jpeg|300]]

$$
\begin{matrix}
i & j & k \\
V_x & V_y & V_z \\
-V_y & V_x & 0
\end{matrix}
$$

$$
\begin{matrix}
V_y & V_z \\
V_x & 0
\end{matrix}

\quad 
-
\begin{matrix}
V_x & V_z \\
-V_y & 0
\end{matrix}
$$

тут дальше вывод этих формул на доске. осознаю и перепишу, фотки есть

![[IMG_1579.jpeg|300]]

![[IMG_1580.jpeg|300]]

## ИМ движения фотонов в многослойных средах

у каждого слоя есть набор параметров

коэф-ты поглощения и рассеивания - вероятности того, что произойдет поглощение/рассеивание?? (нет, но что-то около того)

дальше текст на слайдах 55-56, перепишу потом

у фотона есть некоторое пороговое значение, после которого начинается "русская рулетка" (прям так в источниках и пишут)

![[Pasted image 20250211163632.png]]

нахрена она нужна????

здравый смысл диктует, что мы даем фотону возможность продолжить движение и сгенерить больше инфы

а дальше оцениваем сумму некоторых с.в. $X_1, ..., X_n$. свяжем каждую их них с фотоном

$$
X^\prime = \begin{cases}
\frac{1}{p}X, & \quad \mathbb{P} = p \\
0, & \quad иначе
\end{cases}
$$

один из методов понижения дисперсии оценки. мат. ожидание сохранится, а значит все норм, можно продлить жизнь фотонам не влияя на параметры результатов
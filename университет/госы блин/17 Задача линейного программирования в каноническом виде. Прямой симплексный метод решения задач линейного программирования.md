## 1.1 задача линейного программирования в общем виде
$\underset{j = 1}{\overset{n}{\sum}} c_j x_j \to \max$
$c_j$ — коэффициенты целевой функции.

$\underset{j = 1}{\overset{n}{\sum}} a_{ij} x_j \le b_i$ ($i = 1,\ ...,\ m_1$)

$\underset{j = 1}{\overset{n}{\sum}} a_{ij} x_j \ge b_i$ ($i = m_1+1,\ ...,\ m_1 + m_2$)

$\underset{j = 1}{\overset{n}{\sum}} a_{ij} x_j = b_i$ ($i = m_1 + m_2 + 1,\ ...,\ m_1 + m_2 + m_3$)

всего ограничений — $m_1 + m_2 + m_3$.
$a_{ij}$ — коэффициенты матрицы ограничений.
$b_i$ — правые части ограничений.

множество переменных $N$ может быть разбито на три части:

$N = N_1 \cup N_2 \cup N_3$
$N_1$ — переменные, которые $\ge 0$.
$N_2$ — переменные, которые $<0$.
$N_3$ — переменные, которые могут иметь любой знак. (температура, например)

$N_1 \cap N_2 \cap N_3 = 0$ 

## 1.2 задача линейного программирования в каноническом виде

вопрос заключается в том, чтобы любую задачу привести к вот такому виду:

$$\underset{j = 1}{\overset{n}{\sum}} c_j x_j \to \min$$
$$\underset{j = 1}{\overset{n}{\sum}} a_{ij} x_j = b_i$$
$$x_j \ge 0$$
$$b_i \ge 0$$
## 1.3 приведение задачи ЛП к каноническому виду (алгоритм, общий вид таблицы)

#### 1. если $f \to \max$
просто умножить все $c_j$ на $-1$.
было $2x_1 - 3x_2 \to \max$
стало $-2x_1 + 3x_2 \to \min$

#### 2. если множество $M_1$ ограничений не пусто
(имеются в виду ограничения $g(x) \ge 0$)

вводятся ==дополнительные переменные==.
$x \ge b$
новая переменная $x' > 0$
$x - x' = b$
пример: $b$ - заявка, $x$ - реальный выпуск, $x'$ - перевыпуск (нам сказали сделать не менее чем $b$, мы сделали на $x'$ больше.)

==$\star$== помимо дополнительных переменных есть еще искусственные. я уже забыла, чем они отличаются.

#### 3. если множество $M_2$ ограничений не пусто
(имеются в виду ограничения $g(x) \le 0$)

$x \le b$
новая переменная $x' > 0$
$x + x' = b$
пример: $b$ - заявка, $x$ - реальный выпуск, $x'$ - недовыпуск (нам сказали сделать не более чем $b$, мы сделали на $x'$ меньше.)

#### 4. если $N_2$ не пусто
производится замена переменных.
$x \in N_2$
$x' = -x$
$x' \ge 0$

#### 5. если $N_3$ не пусто
производится замена переменных.
$x \in N_3$
$x^+,\ x^- \ge 0$
$x = x^+ - x^-$

#### 6. если есть $b_i < 0$
просто домножить ограничение (неравенство) на -1, чтобы изменить знак.

## алгоритм прямого симплексного метода
```
или метод последовательного улучшения плана.
```

для того чтобы использовать этот метод, важно наличие двух условий:
1. канонический вид задачи ЛП (то, что в правой части ограничений, должно быть больше нуля)
2. должен быть начальный базис, от которого нужно отталкиваться, и соответствующее ему БДР (базисное допустимое решение). 

$\sum c_j x_j \to \min$
$\sum a_{ij} x_j = b_i$
$x_j \ge 0$

|     |     | $c_1$, $c_2$ ... $c_m$ | $c_{m+1}$ ... $c_n$ |
| --- | --- | ---------------------- | ------------------- |

| базис | бдр        | $x_1$, $x_2$ ... $x_m$           | $x_{m+1}$ ...  $x_n$        |
| ----- | ---------- | -------------------------------- | --------------------------- |
| $x_1$ | $b_1$      | 1                                |                             |
| $x_2$ | $b_2$      |   1                              | $a_{rs}$                    |
| ...   | ...        |     ...                          |                             |
| $x_n$ | $b_n$      |       1                          |                             |
| ———   | ———        | —————                            | ————                        |
| $z$   | $\Delta_0$ | $\Delta_1 \Delta_2 ... \Delta_m$ | $\Delta_{m+1} ... \Delta_n$ |

$\Delta_0 = \underset{i=1}{\overset{m}{\sum}} c_i b_i$

$\Delta_j = \underset{i=1}{\overset{m}{\sum}} c_i a_{ij} - c_j$

## алгоритм
0. построение начальной симплекс таблицы
1. проверка всех $\Delta_j$ (кроме $\Delta_0$): если все $\Delta_j \le 0$, то найдено оптимальное решение. конец алгоритма.
2. среди всех оценок $\Delta > 0$ выбираем наибольшую, и соответствующий ей столбец объявляем ведущим столбцом.
3. просматриваем элементы ведущего столбца. если все элементы $\le 0$, значит функция не ограничена и оптимального решения не существует.
4. для всех $a_{is} > 0$ находим отношения $\dfrac{b_i}{a_{is}}$. берем минимальное из них. $R$ — ведущая строка. ($R$ — мощность строки.)
5. пересчет симплексной таблицы при помощи преобразования Жордана-Гаусса. в строке $R$ записываем $S$, для всех элементов матрицы $a$: $a_{ij} = \dfrac{a_{ij} \cdot a_{rs} - a_{rj} \cdot a_{is}}{a_{rs}}$
   то есть для строки с номером $R$ все значения делятся на опорное значение $S$.
6. возвращаемся к шагу 1.

### пример
$1 x_1 + 2 x_2 + 0 x_3 + 3 x_4 \to \min$
$1 x_1 + 0 x_2 + 2 x_3 + 1 x_4 = 4$
$4 x_1 + 1 x_2 + 6 x_3 + 0 x_4 = 14$
$x_i \ge 0$

можно ли использовать симплекс-метод?
1. все элементы справа больше нуля.
2. нужен начальный базис.
   количество базисных переменных равно количеству ограничений. надо, чтобы они образовывали единичную матрицу. можно менять переменные местами. (грубо говоря, $x_4$ это теперь $x_1$, а $x_1$ это $x_4$.) в конкретном примере можно построить матрицу по переменным $x_4$ и $x_2$.

рисуем таблицу.

|     |     | 1   | 2   | 0   | 3   |
| --- | --- | --- | --- | --- | --- |

| базис   | бдр | $x_1$ | $x_2$ | $x_3$ | $x_4$ |
| ------- | --- | ----- | ----- | ----- | ----- |
| 3 $x_4$ | 4   | 1     | 0     | 2     | 1     |
| 2 $x_2$ | 14  | 4     | 1     | 6     | 0     |
| ——      | ——  | ——    | ——    | ——    | ——    |
| $z$     | 40  | 10    | 0     | 18    | 0     |


$1 \cdot 0 + 0 \cdot x_2 + 2 \cdot 0 + 1 \cdot x_4 = 4$
$4 \cdot 0 + 1 \cdot x_2 + 6 \cdot 0 + 0 \cdot x_4 = 14$

$\begin{cases}0 \cdot x_2 + 1 \cdot x_4 = 4 \Rightarrow x_4 = 4\\ 1 \cdot x-2 + 0 \cdot x_4 = 14 \Rightarrow x_2 = 14\end{cases}$

теперь столбец $x_3$ ведущий. $S = 3$
анализируем ведущий столбец: если все элементы $\le 0$, то задача не решаема. это не так, поэтому считаем отношения бдр к коэффициентам в ведущем столбце.

| базис   | бдр | $x_1$ | $x_2$ | $x_3$  | $x_4$ |              |
| ------- | --- | ----- | ----- | ------ | ----- | ------------ |
| 3 $x_4$ | 4   | ==1== | ==0== | ==2==  | ==1== | $4 \over 2$  |
| 2 $x_2$ | 14  | 4     | 1     | ==6==  | 0     | $14 \over 6$ |
| ——      | ——  | ——    | ——    | ——     | ——    |              |
| $z$       | 40  | 10    | 0     | ==18== | 0     |              |

строка с наименьшим отношением становится ведущий. элемент на пересечении ведущей строки и ведущего столбца - опорный.

|     |     | 1   | 2   | 0   | 3   |
| --- | --- | --- | --- | --- | --- |

| базис   | бдр | $x_1$   | $x_2$ | $x_3$ | $x_4$   |               |
| ------- | --- | ------- | ----- | ----- | ------- | ------------- |
| 0 $x_3$ | 2   | ==0.5== | ==0== | ==1== | ==0.5== | $2 \over 0.5$ |
| 2 $x_2$ | 2** | ==1==   | 1     | 0     | -3      | $2 \over 1$   |
| ——      | ——  | ——      | ——    | ——    | ——      |               |
| $z$     | 4   | ==1==   | 0     | 0     | -9      |               |

** $\dfrac{14 \cdot 2 - 4 \cdot 6}{2}$



|     |     | 1   | 2   | 0   | 3   |
| --- | --- | --- | --- | --- | --- |

| базис   | бдр | $x_1$ | $x_2$ | $x_3$ | $x_4$ |
| ------- | --- | ----- | ----- | ----- | ----- |
| $x_3$ | 1   | 0     | -0.5  | 1     | 2     |
| $x_1$ | 2   | 1     | 1     | 0     | -3    |
| ——      | ——  | ——    | ——    | ——    | ——    |
| $z$       | 2   | 0     | -1    | 0     | -6    |

текущее решение является оптимальным:
$x_1 = 2$
$x_2 = 0$
$x_3 = 1$
$x_4 = 0$
$z^* = 2$
 

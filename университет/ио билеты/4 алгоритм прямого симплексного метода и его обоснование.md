## 4.1 алгоритм прямого симплексного метода
```
или метод последовательного улучшения плана.
```

для того чтобы использовать этот метод, важно наличие двух условий:
1. канонический вид задачи ЛП (то, что в правой части ограничений, должно быть больше нуля)
2. должен быть начальный базис, от которого нужно отталкиваться, и соответствующее ему БДР (базисное допустимое решение). 

$\sum c_j x_j \to \min$
$\sum a_{ij} x_j = b_i$
$x_j \ge 0$

|     |     | $c_1$, $c_2$ ... $c_m$ | $c_{m+1}$ ... $c_n$ |
| --- | --- | ---------------------- | ------------------- |

| базис | бдр        | $x_1$, $x_2$ ... $x_m$           | $x_{m+1}$ ...  $x_n$        |
| ----- | ---------- | -------------------------------- | --------------------------- |
| $x_1$ | $b_1$      | 1                                |                             |
| $x_2$ | $b_2$      |   1                              | $a_{rs}$                    |
| ...   | ...        |     ...                          |                             |
| $x_n$ | $b_n$      |       1                          |                             |
| ———   | ———        | —————                            | ————                        |
| $z$   | $\Delta_0$ | $\Delta_1 \Delta_2 ... \Delta_m$ | $\Delta_{m+1} ... \Delta_n$ |

$\Delta_0 = \underset{i=1}{\overset{m}{\sum}} c_i b_i$

$\Delta_j = \underset{i=1}{\overset{m}{\sum}} c_i a_{ij} - c_j$

## алгоритм
0. построение начальной симплекс таблицы
1. проверка всех $\Delta_j$ (кроме $\Delta_0$): если все $\Delta_j \le 0$, то найдено оптимальное решение. конец алгоритма.
2. среди всех оценок $\Delta > 0$ выбираем наибольшую, и соответствующий ей столбец объявляем ведущим столбцом.
3. просматриваем элементы ведущего столбца. если все элементы $\le 0$, значит функция не ограничена и оптимального решения не существует.
4. для всех $a_{is} > 0$ находим отношения $\dfrac{b_i}{a_{is}}$. берем минимальное из них. $R$ — ведущая строка. ($R$ — мощность строки.)
5. пересчет симплексной таблицы при помощи преобразования Жордана-Гаусса. в строке $R$ записываем $S$, для всех элементов матрицы $a$: $a_{ij} = \dfrac{a_{ij} \cdot a_{rs} - a_{rj} \cdot a_{is}}{a_{rs}}$
   то есть для строки с номером $R$ все значения делятся на опорное значение $S$.
6. возвращаемся к шагу 1.

### пример
$1 x_1 + 2 x_2 + 0 x_3 + 3 x_4 \to \min$
$1 x_1 + 0 x_2 + 2 x_3 + 1 x_4 = 4$
$4 x_1 + 1 x_2 + 6 x_3 + 0 x_4 = 14$
$x_i \ge 0$

можно ли использовать симплекс-метод?
1. все элементы справа больше нуля.
2. нужен начальный базис.
   количество базисных переменных равно количеству ограничений. надо, чтобы они образовывали единичную матрицу. можно менять переменные местами. (грубо говоря, $x_4$ это теперь $x_1$, а $x_1$ это $x_4$.) в конкретном примере можно построить матрицу по переменным $x_4$ и $x_2$.

рисуем таблицу.

|     |     | 1   | 2   | 0   | 3   |
| --- | --- | --- | --- | --- | --- |

| базис   | бдр | $x_1$ | $x_2$ | $x_3$ | $x_4$ |
| ------- | --- | ----- | ----- | ----- | ----- |
| 3 $x_4$ | 4   | 1     | 0     | 2     | 1     |
| 2 $x_2$ | 14  | 4     | 1     | 6     | 0     |
| ——      | ——  | ——    | ——    | ——    | ——    |
| $z$     | 40  | 10    | 0     | 18    | 0     |


$1 \cdot 0 + 0 \cdot x_2 + 2 \cdot 0 + 1 \cdot x_4 = 4$
$4 \cdot 0 + 1 \cdot x_2 + 6 \cdot 0 + 0 \cdot x_4 = 14$

$\begin{cases}0 \cdot x_2 + 1 \cdot x_4 = 4 \Rightarrow x_4 = 4\\ 1 \cdot x-2 + 0 \cdot x_4 = 14 \Rightarrow x_2 = 14\end{cases}$

теперь столбец $x_3$ ведущий. $S = 3$
анализируем ведущий столбец: если все элементы $\le 0$, то задача не решаема. это не так, поэтому считаем отношения бдр к коэффициентам в ведущем столбце.

| базис   | бдр | $x_1$ | $x_2$ | $x_3$  | $x_4$ |              |
| ------- | --- | ----- | ----- | ------ | ----- | ------------ |
| 3 $x_4$ | 4   | ==1== | ==0== | ==2==  | ==1== | $4 \over 2$  |
| 2 $x_2$ | 14  | 4     | 1     | ==6==  | 0     | $14 \over 6$ |
| ——      | ——  | ——    | ——    | ——     | ——    |              |
| $z$       | 40  | 10    | 0     | ==18== | 0     |              |

строка с наименьшим отношением становится ведущий. элемент на пересечении ведущей строки и ведущего столбца - опорный.

|     |     | 1   | 2   | 0   | 3   |
| --- | --- | --- | --- | --- | --- |

| базис   | бдр | $x_1$   | $x_2$ | $x_3$ | $x_4$   |               |
| ------- | --- | ------- | ----- | ----- | ------- | ------------- |
| 0 $x_3$ | 2   | ==0.5== | ==0== | ==1== | ==0.5== | $2 \over 0.5$ |
| 2 $x_2$ | 2** | ==1==   | 1     | 0     | -3      | $2 \over 1$   |
| ——      | ——  | ——      | ——    | ——    | ——      |               |
| $z$     | 4   | ==1==   | 0     | 0     | -9      |               |

** $\dfrac{14 \cdot 2 - 4 \cdot 6}{2}$



|     |     | 1   | 2   | 0   | 3   |
| --- | --- | --- | --- | --- | --- |

| базис   | бдр | $x_1$ | $x_2$ | $x_3$ | $x_4$ |
| ------- | --- | ----- | ----- | ----- | ----- |
| $x_3$ | 1   | 0     | -0.5  | 1     | 2     |
| $x_1$ | 2   | 1     | 1     | 0     | -3    |
| ——      | ——  | ——    | ——    | ——    | ——    |
| $z$       | 2   | 0     | -1    | 0     | -6    |

текущее решение является оптимальным:
$x_1 = 2$
$x_2 = 0$
$x_3 = 1$
$x_4 = 0$
$z^* = 2$
 

## 4.2 обоснование критерия оптимальности
## 4.3 обоснование выбора ведущей строки
## 4.4 обоснование неограниченности целевой функции



$z = \underset{j = 1}{\overset{n}{\sum}} c_j x_j \to \min$

$z = \underset{j = 1}{\overset{n}{\sum}} c_j x_j = \underset{i = 1}{\overset{m}{\sum}} c_i x_j + \underset{j = m+1}{\overset{n}{\sum}} c_j x_j =$
$=\underset{i = 1}{\overset{m}{\sum}}c_i(b_i - \underset{j = m+1}{\overset{n}{\sum}} a_{ij} x_j) + \underset{j = m+1}{\overset{n}{\sum}} c_j x_j =$
$=\underset{i = 1}{\overset{m}{\sum}} c_i b_i - \underset{i = 1}{\overset{m}{\sum}} c_i \underset{j = m+1}{\overset{n}{\sum}} a_{ij} x_j + \underset{j = m+1}{\overset{n}{\sum}} c_j x_j =$
$=\underset{z_0}{\underbrace{\underset{i = 1}{\overset{m}{\sum}} c_i b_i}} - \underset{j = m+1}{\overset{n}{\sum}} \underset{\Delta_j}{\underbrace{\left(\underset{i = 1}{\overset{m}{\sum}} c_i a_{ij} - c_j\right)}} x_j$ $=$ $z_0 - \underset{j = m+1}{\overset{n}{\sum}} \Delta_j x_j$

ищем $x_j$, которую сделаем $>0$.

1. $\Delta_j \le 0\ \forall j$ $\Rightarrow$ текущий базис оптимальный, нечего улучшать.
2. $\exists \Delta_j > 0$ $\Rightarrow$ целевую функцию можно уменьшить. тогда пусть $x_s \sim \Delta_s > 0$. $x_s$ вносим в базис.

==2.1.== $\forall a_{is} \le 0$
$\begin{cases} x_1 = b_1 - x_s a_{1s} \\ x_2 = b_2 - x_s a_{2s} \\ x_3 = b_3 - x_s a_{3s} \end{cases}$
$x_s \to \infty$
$z = z_0 - \Delta_s x_s$
решение можно улучшать бесконечно.

==2.2.== $\exists a_{is} > 0$
$1 x_1 + 2 x_2 + 0 x_3 + 3 x_4 \to \min$
$1 x_1 + 0 x_2 + 2 x_3 + 1 x_4 = 4$
$4 x_1 + 1 x_2 + 6 x_3 + 0 x_4 = 14$
$x_i \ge 0$

$\begin{cases}x_4 = 4 - 3 x_3 \ge 0 \\ x_2 = 14 - 6 x_3 \ge 0\end{cases}$

$\begin{array}{l}4 \ge 2 x_3 \\ 14 \ge 4 x_3 \end{array} \Rightarrow \begin{cases}x_3 \le \dfrac{4}{2} \\ x_3 \le \dfrac{14}{6}\end{cases} \Rightarrow x_3 =2,\ x_4 = 4- 2 \cdot 2 = 0$

|     |     | 1   | 2   | 0   | 3   |
| --- | --- | --- | --- | --- | --- |

| базис   | бдр | $x_1$ | $x_2$ | $x_3$ | $x_4$ |
| ------- | --- | ----- | ----- | ----- | ----- |
| 3 $x_4$ | 4   | 1     | 0     | ==2== | 1     |
| 2 $x_2$ | 14  | 4     | 1     | ==6== | 0     |
| ——      | ——  | ——    | ——    | ——    | ——    |
| $z$     | 40  | 10    | 0     | 18    | 0     |

для всех $a_{is} > 0$ находим симплексное отношение $\dfrac{b_i}{a_{is}}.$ берем наименьшее из них.

я хз, все это или не все. не могу уже думать больше.
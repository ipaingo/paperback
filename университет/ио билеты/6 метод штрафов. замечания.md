
1. строим вспомогательную задачу.

пусть существует исходная задача
$P: z = \sum c_j\ x_j \to \min$
$\sum a_{ij} x_j = b_i$
$x_j \ge 0$

вспомогательная задача $P_2$:
$G = \sum c_j\ x_j + \underset{i=1}{\overset{n}{\sum}} Q\ y_i \to \min$
$Q$ — некоторый большой штрафной коэффициент. суть в том, чтобы с игреками было невыгодно работать.
$m \sim y_i$
$y_i \ge 0$
$\sum a_{ij}\ x_j + y_i = b_i,\ i = 1..m$

#### пример
$P$
$3x_1 + x_2 + x_3 \to \min$
$1x_1 + 2x_2 + 0x_3 + 1x_4 = 2$
$-2x_1 - 1x_2 + 1x_3 - 3x_4 = 1$
$2x_1 + 3x_2 + 0x_3 + 2x_4 = 4$

переменную $x_3$ можно использовать как кусочек базиса, поэтому сопоставим только два игрека.

$P_2$
$3x_1 + x_2 + x_3 + Q\ y_1 + Q\ y_2 \to \min$

$1x_1 + 2x_2 + 0x_3 + 1x_4 + 1y_1 = 2$
$-2x_1 - 1x_2 + 1x_3 - 3x_4 = 1$
$2x_1 + 3x_2 + 0x_3 + 2x_4 + 1y_2 = 4$

|     |     |     | 3   | 1   | 1   | 0   | Q   | Q   | 
| --- | --- | --- | --- | --- | --- | --- | --- | --- |

|          | базис   | бдр   | x_1   | x_2    | x_3   | x_4   | y_1   | y_2   |         |
| -------- | ------- | ----- | ----- | ------ | ----- | ----- | ----- | ----- | ------- |
| Q        | ==y_1== | ==2== | ==1== | ==2==  | ==0== | ==1== | ==1== | ==0== | ==2/2== |
| 1        | x_3     | 1     | -2    | ==-1== | 1     | -3    | 0     | 0     | -       |
| Q        | y_2     | 4     | 2     | ==3==  | 0     | 2     | 0     | 1     | 4/3     |
|          | -----   | ---   | ---   | ---    | ---   | ---   | ---   | ---   |         |
| $\alpha$ | G       | 6     | 3     | ==5==  | 0     | 3     | 0     | 0     |         |
| $\beta$  |         | 1     | -5    | ==-2== | 0     | -3    | 0     | 0     |         |

$G = 2Q + 1 + 4Q = \underset{\alpha}{6}Q + \underset{\beta}{1}$

важно помнить, что $Q$ — очень большое число. нужно учитывать этот факт при определении знака в строке дельт.

|     |     |     | 3   | 1   | 1   | 0   | Q   | Q   | 
| --- | --- | --- | --- | --- | --- | --- | --- | --- |

|          | базис | бдр | x_1  | x_2 | x_3 | x_4  | y_1  | y_2 |     |
| -------- | ----- | --- | ---- | --- | --- | ---- | ---- | --- | --- |
| 1        | x_2   | 1   | 1/2  | 1   | 0   | 1/2  | 1/2  | 0   |     |
| 1        | x_3   | 2   | -3/2 | 0   | 1   | -5/2 | 1/2  | 0   |     |
| Q        | y_2   | 1   | 1/2  | 0   | 0   | ==1/2==  | -3/2 | 1   |     |
|          | ----- | --- | ---  | --- | --- | ---  | ---  | --- |     |
| $\alpha$ | G     | 1   | 1/2  | 0   | 0   | 1/2  | -5/2 | 0   |     |
| $\beta$  |       | 3   | -4   | 0   | 0   | -2   | 1    | 0   |     |
 


$\dfrac{(6Q+1) \cdot 2 - 2 \cdot (5Q - 2)}{2} = \dfrac{12Q + 2 - 10Q +4}{2} = \dfrac{2Q+6}{2} = Q+3$
НО правило прямоугольника можно применять к $\alpha$ и $\beta$ по отдельности. можно воспринимать их как две строки.


|     |     |     | 3   | 1   | 1   | 0   | Q   | Q   | 
| --- | --- | --- | --- | --- | --- | --- | --- | --- |

|          | базис | бдр | x_1 | x_2 | x_3 | x_4 | y_1 | y_2 |     |
| -------- | ----- | --- | --- | --- | --- | --- | --- | --- | --- |
| 1        | x_2   | 0   | 0   | 1   | 0   | 0   | 2   | -1  |     |
| 1        | x_3   | 7   | 1   | 0   | 1   | 0   | -7  | 5   |     |
| 0        | x_4   | 2   | 1   | 0   | 0   | 1   | -3  | 2   |     |
|          | ----- | --- | --- | --- | --- | --- | --- | --- |     |
| $\alpha$ | G     | 0   | 0   | 0   | 0   | 0   | -1  | -1  |     |
| $\beta$  |       | 7   | -2  | 0   | 0   | 0   | -5  | 4   |     |

$G^* = 7$
$x_1 = 0$
$x_2 = 0$
$x_3 = 7$
$x_4 = 2$
